import{n as x,A as y,k as E,T as V,ah as D,ai as Z,v as A,aj as W,p as L,q as P,c as _,d as R,x as N,a as d,ak as $,e as K,ae as J,i as p,al as j,am as G,w as H,m as z,b as Q,an as X,G as ee,ac as oe,ao as ne,ap as te,aq as ae,a4 as se,ar as le,as as ce,K as re,H as ie,I as de}from"./index.b5f2d632.js";import{u as ue,a as fe}from"./index.7dad203a.js";const ve={show:Boolean,zIndex:x,overlay:y,duration:x,teleport:[String,Object],lockScroll:y,lazyRender:y,beforeClose:Function,overlayStyle:Object,overlayClass:E,transitionAppear:Boolean,closeOnClickOverlay:y};let h=0;const g="van-overflow-hidden";function ye(e,o){const t=ue(),u="01",a="10",c=r=>{t.move(r);const f=t.deltaY.value>0?a:u,S=W(r.target,e.value),{scrollHeight:m,offsetHeight:k,scrollTop:w}=S;let v="11";w===0?v=k>=m?"00":"01":w+k>=m&&(v="10"),v!=="11"&&t.isVertical()&&!(parseInt(v,2)&parseInt(f,2))&&L(r,!0)},s=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",c,{passive:!1}),h||document.body.classList.add(g),h++},l=()=>{h&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",c),h--,h||document.body.classList.remove(g))},C=()=>o()&&s(),I=()=>o()&&l();V(C),D(I),Z(I),A(o,r=>{r?s():l()})}function M(e){const o=P(!1);return A(e,t=>{t&&(o.value=t)},{immediate:!0}),t=>()=>o.value?t():null}const[me,he]=_("overlay"),Ie={show:Boolean,zIndex:x,duration:x,className:E,lockScroll:y,lazyRender:y,customStyle:Object};var ke=R({name:me,props:Ie,setup(e,{slots:o}){const t=P(),u=M(()=>e.show||!e.lazyRender),a=s=>{e.lockScroll&&L(s,!0)},c=u(()=>{var s;const l=K(J(e.zIndex),e.customStyle);return p(e.duration)&&(l.animationDuration=`${e.duration}s`),j(d("div",{ref:t,style:l,class:[he(),e.className]},[(s=o.default)==null?void 0:s.call(o)]),[[G,e.show]])});return N("touchmove",a,{target:t}),()=>d($,{name:"van-fade",appear:!0},{default:c})}});const we=H(ke),Oe=K({},ve,{round:Boolean,position:z("center"),closeIcon:z("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:z("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[xe,B]=_("popup");var Pe=R({name:xe,inheritAttrs:!1,props:Oe,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:o,attrs:t,slots:u}){let a,c;const s=P(),l=P(),C=M(()=>e.show||!e.lazyRender),I=Q(()=>{const n={zIndex:s.value};if(p(e.duration)){const i=e.position==="center"?"animationDuration":"transitionDuration";n[i]=`${e.duration}s`}return n}),r=()=>{a||(a=!0,s.value=e.zIndex!==void 0?+e.zIndex:le(),o("open"))},f=()=>{a&&ce(e.beforeClose,{done(){a=!1,o("close"),o("update:show",!1)}})},S=n=>{o("click-overlay",n),e.closeOnClickOverlay&&f()},m=()=>{if(e.overlay)return d(we,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:S},{default:u["overlay-content"]})},k=n=>{o("click-close-icon",n),f()},w=()=>{if(e.closeable)return d(de,{role:"button",tabindex:0,name:e.closeIcon,class:[B("close-icon",e.closeIconPosition),ie],classPrefix:e.iconPrefix,onClick:k},null)},v=()=>o("opened"),F=()=>o("closed"),U=n=>o("keydown",n),Y=C(()=>{var n;const{round:i,position:O,safeAreaInsetTop:b,safeAreaInsetBottom:q}=e;return j(d("div",re({ref:l,style:I.value,role:"dialog",tabindex:0,class:[B({round:i,[O]:O}),{"van-safe-area-top":b,"van-safe-area-bottom":q}],onKeydown:U},t),[(n=u.default)==null?void 0:n.call(u),w()]),[[G,e.show]])}),T=()=>{const{position:n,transition:i,transitionAppear:O}=e,b=n==="center"?"van-fade":`van-popup-slide-${n}`;return d($,{name:i||b,appear:O,onAfterEnter:v,onAfterLeave:F},{default:Y})};return A(()=>e.show,n=>{n&&!a&&(r(),t.tabindex===0&&X(()=>{var i;(i=l.value)==null||i.focus()})),!n&&a&&(a=!1,o("close"))}),fe({popupRef:l}),ye(l,()=>e.show&&e.lockScroll),N("popstate",()=>{e.closeOnPopstate&&(f(),c=!1)}),ee(()=>{e.show&&r()}),oe(()=>{c&&(o("update:show",!0),c=!1)}),D(()=>{e.show&&e.teleport&&(f(),c=!0)}),ne(te,()=>e.show),()=>e.teleport?d(ae,{to:e.teleport},{default:()=>[m(),T()]}):d(se,null,[m(),T()])}});const be=H(Pe);export{be as P};
